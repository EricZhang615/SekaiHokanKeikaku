# Optimization Everything Everywhere All at Once

## 凸分析

$f(x)$ 二次可微，每一点海森矩阵半正定 $\iff$ $f(x)$ 凸函数

>**判断矩阵正定/半正定**
>$n$阶实对称矩阵$A$正定：
>- 特征值$\lambda \gt 0$
>- 顺序主子式$\gt 0$
>
>$n$阶实对称矩阵$A$半正定：
>- 特征值$\lambda \ge 0$

>**特征值**
>$|\lambda E-A| = 0$，$E$为单位矩阵

>**行列式计算**
>二阶：$a_{11}a_{22}-a_{12}a_{21}$
三阶：$a_{11}a_{22}a_{33}+a_{12}a_{23}a_{31}+a_{13}a_{21}a_{12}-a_{31}a_{22}a_{13}-a_{12}a_{21}a_{33}-a_{11}a_{23}a_{32}$
按行展开：$a_{i1}A_{i1}+a_{i2}A_{i2}+\cdots+a_{in}A_{in}$
代数余子式：$A_{ij}={(-1)}^{i+j}M_{ij}$

## 线性规划

### 线性规划的标准形式
1. 目标函数为$\max$
2. 约束条件为等式
   - 约束条件为$\le$形式。不等式的左端加上一个非负的新变量即可化为等式。新增的非负变量成为松弛变量。
   - 约束条件为$\ge$形式。不等式的左端减去一个非负的新变量即可化为等式。新增的非负变量称为剩余变量，亦可以称为松弛变量。
3. 约束条件右边$b_{j}\ge0$
4. 决策变量正约束
   - $x_{j}\le 0$，则用非负变量$x_{j}'$代替，使$x_{j}'=-x_{j}$
   - $x_{j}$符号不受限制，用两个非负的新变量之差来代替。
   - 决策变量有上下界。对这种情况，可将上下界分别处理。引进新的变量使等于原变量减去上下限值，如此则下限为零，满足标准形式的非负性要求，再将上限约束列为新的约束条件并化为等式。 

## 单纯形方法

### 单纯形表法

若检验数小于0，$b/a\le0$，则无界

若$X_B$对应的变量以外的变量的检验数有等于0的，则当前解为无穷多最优解之一

### 两阶段法

先添加人工变量，构造一阶段问题，极小化人工变量目标函数$\min x_{1}'+x_{2}'+\cdots+x_{j}'$，求解一阶段问题

一阶段最终单纯形表中，若人工变量不是基变量，原线性规划有最优解，否则原线性规划没有最优解。

去掉一阶段最终单纯形表中人工变量列，替换目标函数为原问题，重新计算判别数，并用初等行变换修正判别数（基变量判别数为0），继续求解二阶段问题。

### 大M法

添加人工变量，设$M$为无穷大值，令目标函数为$\max x_{1}+\cdots +x_{j}-Mx_{j}'$，之后按单纯形表法求解

必须换出人工变量

### 求单纯形表中的未知数

1. 找到只有一个未知数的${x_j}$列，根据判别数求未知数
2. 写出矩阵$B, B^{-1}, N, N_1, b, b_1$
   - $B$:在非初始单纯形表中找到$X_B$下方的变量，把这些变量按自左向右的顺序排列，找到初始单纯形表中这些变量下方的非$\sigma$元素，将这些元素按顺序排列形成一个新的矩阵
   - $B^{-1}$:在初始单纯形表中找到单位矩阵，非初始单纯形表中同位置的矩阵就是$B^{-1}$
   - $N$:找出初始单纯形表的$X_B$列和非初始单纯形表的$X_B$列中包含的所有变量，在初始单纯形表中标出这些变量，剩余的变量对应的系数矩阵就是$N$
   - $N^{-1}$:非初始单纯形表中与$N$同位置的矩阵
   - $b$:初始单纯形表中$b$列元素构成的矩阵
   - $b_1$:非初始单纯形表中$b$列元素构成的矩阵
3. 根据下方的矩阵运算公式列方程组求解：
$N_1=B^{-1}N, b_1=B^{-1}b, BB^{-1}=E$

## 对偶问题

### 写对偶问题

1. 确定对偶问题中变量的个数m，原大括号中约束条件的个数m等于对偶问题中的变量个数
2. 确定对偶问题的目标函数
   - 若原目标函数是求$\max$，则对偶问题的目标函数为
   $\min\alpha=b_1y_1+b_2y_2+\cdots+b_my_m$
   - 若原目标函数是求$\min$，则对偶问题的目标函数为
   $\max\alpha=b_1y_1+b_2y_2+\cdots+b_my_m$
   - $b_1, b_2, \cdots, b_m$依次对应原大括号中约束条件右端的常数
3. 确定对偶问题中约束条件的个数n，n=原线性规划问题中变量的个数
4. 确定对偶问题中约束条件左边部分，原系数矩阵的转置
5. 确定对偶问题中约束条件右边的常数，第$n$行式子右边的常数是原问题目标函数中$x_n$的系数
6. 确定对偶问题里约束条件中的符号
   （大同小异）
   |原问题的$x_i$|原目标函数$\max$|原目标函数$\min$|
   |:-:|:-:|:-:|
   |$\le0$|$\le$|$\ge$|
   |$\ge0$|$\ge$|$\le$|
   |无约束|$=$|$=$|
7. 确定对偶问题中变量的范围
   （小同大异）
   |原问题式子|原目标函数$\max$|原目标函数$\min$|
   |:-:|:-:|:-:|
   |$\le$|$\ge0$|$\le0$|
   |$\ge$|$\le0$|$\ge0$|
   |$=$|无约束|无约束|

### 对偶问题的性质
1. 一个问题对偶问题的对偶问题是这个问题本身
2. 若原问题是A，A的对偶问题是B，若A有最优解，则B一定有最优解，且A取最优解时A的目标函数值与B取最优解时B的目标函数值相同
3. 若原问题是A，A的对偶问题是B，则
   - A的解是无界解时，B无可行解
   - B的解是无界解时，A无可行解
4. 若原问题是A，A的对偶问题是B，则
   - A无可行解时，B的解是无界解或无可行解
   - B无可行解时，A的解是无界解或无可行解

### 求对偶问题的最优解

1. 用单纯形法画出原线性规划问题的最终单纯形表
2. 求$Y=C_BB^{-1}$
   - $C_B$:令$c_B$下方的数字依次从左向右排列构成的矩阵

### 求原问题的最优解

1. 写出对偶问题
2. 在对偶问题“{"中约束条件的后方依次写上原问题的变量
3. 改变对偶问题约束条件的符号
   $\ge$变成$\gt$; $\le$变成$\lt$
4. 把对偶问题的最优解代入第3步新得到的不等式中，若不等式成立，则该不等式后方的原问题变量=0
5. 若对偶问题最优解中$y_i^*\ne0$，则原问题“{"中第$i$行约束条件的符号变成等号，得到一个式子
6. 联立4,5步的结果求解
7. 将所有求得的原问题变量的值按从左到右的顺序写到一个括号中得到原问题的最优解